<!DOCTYPE html><html lang="en"><head><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://6736b650aafa2ef22231484b.mockapi.io https://apps.apple.com http://itunes.apple.com https://is1-ssl.mzstatic.com https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com https://api.qimai.cn https://www.qimai.cn; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iTunes App Lookup</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .rounded-image {
            border: 0.5px solid #000; /* 设置边框为0.5px实线 */
            border-radius: 13px; /* 设置圆角为16px */
            width: 60px;
        }
        ul {
            list-style-type: none;
            padding: 0;
        }

        li {
            margin-bottom: 10px;
        }
        .cell {
            padding: 10px;
            border-bottom: 1px solid #ccc;
             cursor: pointer;
        }
        .error {
            color: red;
                        border-bottom: 1px solid #ccc;
            font-style: italic;
            cursor: pointer;
        }
         .floating-button {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        font-size: 24px;
        cursor: pointer;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }
    </style>
</head>

<body>
    <h1 id="dynamic-title">iTunes App Lookup</h1>
    <ul id="appList"></ul>
    <button class="floating-button" onclick="handleButtonClick()">+</button>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        const titleElement = document.getElementById('dynamic-title');
        var c1 = 0
        var c2 = 0
    function handleButtonClick() {
    // Add your logic for the button click here    //
    window.open(`https://mockapi.io/projects/6736b650aafa2ef22231484c`)
    // You can add any actions you want to perform when the button is clicked
}
        const appListElement = document.getElementById('appList');
        function onItemClick(event) {
            // Add your click event handling logic here
            // console.log('Item clicked:', event.target.appInfo.trackId);
        const trackId = event.currentTarget.getAttribute('data-trackid');

        const isMobile = /iPhone/i.test(navigator.userAgent);
        
        if (isMobile) {
            Swal.fire({
                    title: 'You want',
                    icon: 'info',
                    showCancelButton: true,
                    showCloseButton: true,
                    confirmButtonText: 'AppStore',
                    cancelButtonText: '七麦'
                }).then((result) => {
                    if (result.isConfirmed) {
                        // 用户点击了自定义确定按钮
                        window.open(`https://apps.apple.com/cn/app/id${trackId}`)

                        
                    } else if (result.dismiss === Swal.DismissReason.cancel) {
                        // 用户点击了自定义取消按钮
                        if (trackId) {
                            window.open(`https://www.qimai.cn/app/baseinfo/appid/${trackId}/country/cn`)
                                // window.open = ; // Redirect to the app details page
                            }
                      
                    }
                });
         
            
        }else{
            if (trackId) {
                window.open(`https://www.qimai.cn/app/baseinfo/appid/${trackId}/country/cn`)
                    // window.open = ; // Redirect to the app details page
                }
        }
                        
        console.log('Item clicked11:', trackId);

        }
        var timeout = 0
        
        fetch('https://6736b650aafa2ef22231484b.mockapi.io/apps')
            .then(response => response.json())
            .then(data => {
                data.forEach(appId => {
                    fetch(`http://itunes.apple.com/lookup?id=${appId}&date=${Date.now()}`)
                        .then(response => response.json())
                        .then(appData => {
                            
                           const appInfo = appData.results[0];
                        const appListItem = document.createElement('li');
                        appListItem.classList.add('cell'); // Add cell class

                        // Setting up the content of the list item
                        const img = document.createElement('img');
                        img.src = appInfo.artworkUrl60;
                        appListItem.appendChild(img);
                        img.classList.add('rounded-image');

                        const appName1 = document.createElement('span');
                        appName1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
                        appListItem.appendChild(appName1);

                        const appName = document.createElement('span');
                        appName.textContent = appInfo.trackName;
                        appListItem.appendChild(appName);

                        const appName11 = document.createElement('span');
                        appName11.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
                        appListItem.appendChild(appName11);

                    const releaseDate = new Date(appInfo.currentVersionReleaseDate);
                        const currentDate = new Date();
                        const daysDiff = Math.ceil((currentDate - releaseDate) / (1000 * 60 * 60 * 24));
                        
                        appListItem.setAttribute('data-trackid', appInfo.trackId); // Set data attribute for track ID

                        const version = document.createElement('span');
                        version.textContent = `v ${appInfo.version}`;
                        appListItem.appendChild(version);
                        
                        const appName111 = document.createElement('span');
                        appName111.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
                        appListItem.appendChild(appName111);
                        
                        const currentVersionReleaseDate = document.createElement('span');
                        currentVersionReleaseDate.textContent = `${appInfo.currentVersionReleaseDate.split('T')[0]}`;
                        appListItem.appendChild(currentVersionReleaseDate);
                        
                        const appName121 = document.createElement('span');
                        appName121.innerHTML = "&nbsp;&nbsp;&nbsp";
                        appListItem.appendChild(appName121);
                        
                        const appDetails = document.createElement('span');
                        appDetails.textContent = `(${daysDiff} day)`;
                        appListItem.appendChild(appDetails);
                        
                        appListItem.addEventListener('click', onItemClick);
                        // appListElement.appendChild(appListItem);
                        localStorage.setItem(appId, appInfo.trackName);
                        localStorage.setItem(`tm${appId}`,`${appInfo.currentVersionReleaseDate.split('T')[0]}`)
                        
                        appListElement.insertBefore(appListItem, appListElement.firstChild);
                        })
                        .catch(error => {
                            c2 = c2 + 1;
                            c1 = data.length - c2;
                            titleElement.textContent = `iTunes App Lookup : 在线: ${c1}  下架: ${c2}`;
                            
                            // 模拟qimai
                            function getAnalysis(url, params) {
                                function o() {
                                    return unescape("861831832863830866861836861862839831831839862863839830865834861863837837830830837839836861835833".replace(/8/g, "%u00"));
                                }

                                function i() {
                                    var e = "";
                                    ["66", "72", "6f", "6d", "43", "68", "61", "72", "43", "6f", "64", "65"].forEach(function(t) {
                                        e += unescape("%u00" + t);
                                    });
                                    return e;
                                }

                                function r(e) {
                                    var t = i();
                                    return String[t](e);
                                }

                                function f(e, t) {
                                    t || (t = o());
                                    e = e.split("");
                                    var array = new Array(e.length);

                                    for (var n = e.length, a = t.length, s = 0; s < n; s++) {
                                        array[s] = String.fromCharCode(e[s].charCodeAt(0) ^ t.charCodeAt(s % a));
                                    }
                                    return array.join("");
                                }

                                function getData(s1) {
                                    var s2 = '0000000c735d856';
                                    return f(s1, s2);
                                }

                                var r = Array.from(params).sort().join('');
                                var base64_r = btoa(unescape(encodeURIComponent(r)));

                                var base_url = 'https://api.qimai.cn';
                                var timestamp = Math.round(new Date().getTime() - 1661224081041);
                                var _ = '@#';

                                var str_r = base64_r + _ + url + _ + timestamp + _ + '1';
                                str_r = str_r.replace(base_url, '');

                                var an = getData(str_r);
                                var analysis = btoa(unescape(encodeURIComponent(an)));

                                return analysis;
                            }

                            // 调用getAnalysis函数并获取结果
                            var url = 'https://api.qimai.cn/app/appinfo';
                            var params = 'appid=${appId}&country=cn';
                            var analysis = getAnalysis(url, params);
                            
                            const qimaiOff = localStorage.getItem(`qimai_${appId}`);
                            if (qimaiOff === null) {
                                const randomNumber = Math.random() * 4;
                                timeout = timeout+randomNumber;
                                setTimeout(() => {
                                    fetch(`https://api.qimai.cn/app/appinfo?analysis=${analysis}&appid=${appId}&country=cn`)
                                    .then(response => response.json())
                                    .then(qmappData => {
                                        if (qmappData.code == 10000) {
                                            console.log(`ok`);
                                            console.log(qmappData.appInfo);
                                            if (qmappData.appInfo.online == false) {
                                                localStorage.setItem(`qimai_${appId}`, JSON.stringify(qmappData.appInfo));
                                                const errorListItem = document.createElement('li');
                                                
                                                const img = document.createElement('img');
                                                img.src = qmappData.appInfo.icon;
                                                errorListItem.appendChild(img);
                                                img.classList.add('rounded-image');
                                                
                                                const appName1 = document.createElement('span');
                                                appName1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
                                                errorListItem.appendChild(appName1);
                                                
                                                const appName = document.createElement('span');
                                                appName.textContent = qmappData.appInfo.appname;
                                                errorListItem.appendChild(appName);
                                                
                                                const cxx = document.createElement('span');
                                                cxx.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
                                                errorListItem.appendChild(cxx);
                                                
                                                const ivv = document.createElement('span');
                                                ivv.textContent = qmappData.appInfo.offline;
                                                errorListItem.appendChild(ivv);
                                                
                                                const cxx1 = document.createElement('span');
                                                cxx1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
                                                errorListItem.appendChild(cxx1);
                                                
                                                const ivv1 = document.createElement('span');
                                                ivv1.textContent = qmappData.appInfo.version;
                                                errorListItem.appendChild(ivv1);
                                                
                                                
                                                errorListItem.classList.add('error');
                                                errorListItem.setAttribute('data-trackid', appId); // Set data attribute for track ID
                                                
                                                errorListItem.addEventListener('click', onItemClick);
                                                appListElement.appendChild(errorListItem);
                                                
                                            }
                                        }else{
                                            console.log(qmappData);
                                            const errorListItem = document.createElement('li');
                                            const cachedData = localStorage.getItem(appId);
                                            const cachedData1 = localStorage.getItem(`tm${appId}`);
                                            
                                            if (localStorage.getItem(`offtm${appId}`) === null) {
                                                const now = new Date();
                                                const year = now.getFullYear();
                                                const month = String(now.getMonth() + 1).padStart(2, '0'); // 月份从 0 开始
                                                const day = String(now.getDate()).padStart(2, '0');
                                                const dateString = `${year}-${month}-${day}`;
                                                localStorage.setItem(`offtm${appId}`, dateString);
                                            }
                                            const _offtime = localStorage.getItem(`offtm${appId}`);
                                            
                                            errorListItem.textContent = `已下架: ${appId}  \t   ${cachedData}  \t  上架时间：${cachedData1}  \t  下架时间：${_offtime}`;
                                            if (cachedData1 === null) {
                                                errorListItem.textContent = `已下架: ${appId}  \t  ${cachedData}  \t  下架时间：${_offtime}`;
                                            }
                                            if (cachedData === null) {
                                                errorListItem.textContent = `已下架: ${appId}  \t  上架时间：${cachedData1}  \t  下架时间：${_offtime}`;
                                            }
                                            if (cachedData === null && cachedData1 === null) {
                                                errorListItem.textContent = `已下架: ${appId}  \t  下架时间：${_offtime}`;
                                            }
                                            
                                            errorListItem.classList.add('error');
                                            errorListItem.setAttribute('data-trackid', appId); // Set data attribute for track ID
                                            
                                            errorListItem.addEventListener('click', onItemClick);
                                            appListElement.appendChild(errorListItem);
                                        }
                                    })
                                    .catch(error => {
                                        console.log(`请安装下插件：`+`https://chromewebstore.google.com/detail/cors-unblock/lfhmikememgdcahcdlaciloancbhjino`)
                                        const errorListItem = document.createElement('li');
                                        const cachedData = localStorage.getItem(appId);
                                        const cachedData1 = localStorage.getItem(`tm${appId}`);
                                        
                                        if (localStorage.getItem(`offtm${appId}`) === null) {
                                            const now = new Date();
                                            const year = now.getFullYear();
                                            const month = String(now.getMonth() + 1).padStart(2, '0'); // 月份从 0 开始
                                            const day = String(now.getDate()).padStart(2, '0');
                                            const dateString = `${year}-${month}-${day}`;
                                            localStorage.setItem(`offtm${appId}`, dateString);
                                        }
                                        const _offtime = localStorage.getItem(`offtm${appId}`);
                                        
                                        errorListItem.textContent = `已下架: ${appId}  \t   ${cachedData}  \t  上架时间：${cachedData1}  \t  下架时间：${_offtime}`;
                                        if (cachedData1 === null) {
                                            errorListItem.textContent = `已下架: ${appId}  \t  ${cachedData}  \t  下架时间：${_offtime}`;
                                        }
                                        if (cachedData === null) {
                                            errorListItem.textContent = `已下架: ${appId}  \t  上架时间：${cachedData1}  \t  下架时间：${_offtime}`;
                                        }
                                        if (cachedData === null && cachedData1 === null) {
                                            errorListItem.textContent = `已下架: ${appId}  \t  下架时间：${_offtime}`;
                                        }
                                        
                                        errorListItem.classList.add('error');
                                        errorListItem.setAttribute('data-trackid', appId); // Set data attribute for track ID
                                        
                                        errorListItem.addEventListener('click', onItemClick);
                                        appListElement.appendChild(errorListItem);
                                    });
                                    
                                }, 1000+timeout*1000); // 3秒后显示

                            }else{
                                const errorListItem = document.createElement('li');
                                errorListItem.classList.add('cell'); // Add cell class
                                const storedAppInfo = JSON.parse(qimaiOff);

                               const img = document.createElement('img');
                               img.src = storedAppInfo.icon;
                               errorListItem.appendChild(img);
                               img.classList.add('rounded-image');
                               console.log(qimaiOff.icon)
                               
                               const appName1 = document.createElement('span');
                               appName1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
                               errorListItem.appendChild(appName1);

                               const appName = document.createElement('span');
                               appName.textContent = storedAppInfo.appname;
                               errorListItem.appendChild(appName);
                               
                               const cxx = document.createElement('span');
                               cxx.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
                               errorListItem.appendChild(cxx);
                               
                               const ivv = document.createElement('span');
                               ivv.textContent = storedAppInfo.offline;
                               errorListItem.appendChild(ivv);
                               
                               const cxx1 = document.createElement('span');
                               cxx1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
                               errorListItem.appendChild(cxx1);
                               
                               const ivv1 = document.createElement('span');
                               ivv1.textContent = storedAppInfo.version;
                               errorListItem.appendChild(ivv1);
                               
                               
                                errorListItem.classList.add('error');
                                errorListItem.setAttribute('data-trackid', appId); // Set data attribute for track ID

                                errorListItem.addEventListener('click', onItemClick);
                                appListElement.appendChild(errorListItem);
                            }
                            // end模拟qimai
                        });
                });
            })
            .catch(error => {
                const errorListItem = document.createElement('li');
                errorListItem.textContent = 'Error fetching app IDs from the API';
                errorListItem.classList.add('error');
                errorListItem.addEventListener('click', onItemClick);
                appListElement.appendChild(errorListItem);
            });
    </script>



</body></html>
